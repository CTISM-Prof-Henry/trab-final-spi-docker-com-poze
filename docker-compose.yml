stages:
  - validate

validate_files:
  stage: validate
  image: alpine:latest
  script:
    - echo "=== VALIDAÃ‡ÃƒO DA ESTRUTURA DO PROJETO ==="
    - echo "ğŸ“ Estrutura de arquivos:"
    - find . -type f -name "*.yml" -o -name "Dockerfile*" | sort
    - echo ""
    - echo "âœ… Verificando arquivos obrigatÃ³rios:"
    - test -f backend/Dockerfile && echo "âœ… backend/Dockerfile - EXISTE"
    - test -f frontend/Dockerfile && echo "âœ… frontend/Dockerfile - EXISTE" 
    - test -f docker-compose.yml && echo "âœ… docker-compose.yml - EXISTE"
    - test -f .gitlab-ci.yml && echo "âœ… .gitlab-ci.yml - EXISTE"
    - echo ""
    - echo "ğŸ” Validando sintaxe YAML:"
    - echo "Validando docker-compose.yml..."
    - python3 -c "import yaml; yaml.safe_load(open('docker-compose.yml'))" && echo "âœ… docker-compose.yml - SINTÃXE VÃLIDA"
    - echo "Validando .gitlab-ci.yml..."
    - python3 -c "import yaml; yaml.safe_load(open('.gitlab-ci.yml'))" && echo "âœ… .gitlab-ci.yml - SINTÃXE VÃLIDA"
    - echo ""
    - echo "ğŸ“‹ ConteÃºdo dos Dockerfiles:"
    - echo "=== BACKEND DOCKERFILE ==="
    - cat backend/Dockerfile
    - echo ""
    - echo "=== FRONTEND DOCKERFILE ==="
    - cat frontend/Dockerfile
    - echo ""
    - echo "ğŸ‰ TODAS AS VALIDAÃ‡Ã•ES FORAM BEM-SUCEDIDAS!"
    - echo "ğŸš€ ConfiguraÃ§Ã£o pronta para Docker Swarm e CI/CD"
  only:
    - dev
    - main